{% extends 'base.html' %}
{% load static %}

{% block title %}Logs de Auditoria - Admin{% endblock %}

{% block content %}
<div class="admin-page">
    <div class="container">
        <h1 class="page-title">ðŸ“œ Logs de Auditoria</h1>
        
        <div class="filters-bar">
            <select id="actionFilter" class="form-control" onchange="filterLogs()">
                <option value="all">Todas AÃ§Ãµes</option>
                <option value="CREATE">Criar</option>
                <option value="UPDATE">Atualizar</option>
                <option value="DELETE">Deletar</option>
            </select>
        </div>

        <div id="logsList" class="logs-list">
            <!-- Loaded dynamically -->
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
document.addEventListener('DOMContentLoaded', loadLogs);

async function loadLogs() {
    try {
        const response = await fetchAPI('/api/admin/audit-logs/');
        const logs = await response.json();
        
        document.getElementById('logsList').innerHTML = logs.map(log => `
            <div class="log-card">
                <span class="log-action ${log.action.toLowerCase()}">${log.action}</span>
                <p><strong>${log.user_name}</strong> ${log.description}</p>
                <span class="log-time">${new Date(log.created_at).toLocaleString('pt-BR')}</span>
            </div>
        `).join('');
    } catch (error) {
        console.error(error);
    }
}

function filterLogs() {
    loadLogs(); // Simplificado
}

window.filterLogs = filterLogs;
</script>
{% endblock %}

