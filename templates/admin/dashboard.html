{% extends 'base.html' %}
{% load static %}

{% block title %}Dashboard Admin - Barbearia Francisco{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/admin.css' %}">
{% endblock %}

{% block content %}
<div class="admin-layout">
    <!-- Admin Header -->
    <div class="admin-header">
        <div class="container">
            <h1>üõ°Ô∏è Painel Administrativo</h1>
            <div class="admin-user">
                <span id="adminUserName">Administrador</span>
                <button class="btn btn-outline btn-sm" onclick="window.location.href='{% url 'home' %}'">Voltar ao Site</button>
            </div>
        </div>
    </div>
    
    <!-- Admin Navigation -->
    <div class="admin-nav">
        <div class="container">
            <div class="admin-tabs">
                <button class="admin-tab active" data-tab="dashboard">Dashboard</button>
                <button class="admin-tab" data-tab="agendamentos">Agendamentos</button>
                <button class="admin-tab" data-tab="servicos">Servi√ßos</button>
                <button class="admin-tab" data-tab="barbeiros">Barbeiros</button>
                <button class="admin-tab" data-tab="cupons">Cupons</button>
            </div>
        </div>
    </div>
    
    <!-- Admin Content -->
    <div class="admin-content">
        <div class="container">
            <!-- Dashboard Tab -->
            <div class="admin-tab-content active" data-content="dashboard">
                <h2>Dashboard</h2>
                
                <!-- Filtro de Per√≠odo -->
                <div class="dashboard-controls">
                    <select id="timeRange" class="form-control">
                        <option value="7days">7 dias</option>
                        <option value="30days" selected>30 dias</option>
                        <option value="90days">90 dias</option>
                    </select>
                    <button class="btn btn-outline btn-sm" id="refreshStats">üîÑ Atualizar</button>
                </div>
                
                <!-- M√©tricas -->
                <div id="dashboardStats" class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon">üí∞</div>
                        <div class="stat-content">
                            <div class="stat-value" id="stat_revenue">R$ 0,00</div>
                            <div class="stat-label">Faturamento</div>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">üìÖ</div>
                        <div class="stat-content">
                            <div class="stat-value" id="stat_appointments">0</div>
                            <div class="stat-label">Agendamentos</div>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">‚úÖ</div>
                        <div class="stat-content">
                            <div class="stat-value" id="stat_completed">0</div>
                            <div class="stat-label">Completados</div>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">‚è≥</div>
                        <div class="stat-content">
                            <div class="stat-value" id="stat_pending">0</div>
                            <div class="stat-label">Pendentes</div>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">üë®‚Äçüíº</div>
                        <div class="stat-content">
                            <div class="stat-value" id="stat_barbers">0</div>
                            <div class="stat-label">Barbeiros Ativos</div>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">üí≥</div>
                        <div class="stat-content">
                            <div class="stat-value" id="stat_avg_ticket">R$ 0,00</div>
                            <div class="stat-label">Ticket M√©dio</div>
                        </div>
                    </div>
                </div>
                
                <!-- Agendamentos de Hoje -->
                <div class="today-section">
                    <h3>Agendamentos de Hoje</h3>
                    <div class="today-cards">
                        <div class="today-card success">
                            <div class="today-icon">‚úÖ</div>
                            <div class="today-value" id="today_completed">0</div>
                            <div class="today-label">Conclu√≠dos</div>
                        </div>
                        <div class="today-card warning">
                            <div class="today-icon">‚è≥</div>
                            <div class="today-value" id="today_pending">0</div>
                            <div class="today-label">Pendentes</div>
                        </div>
                        <div class="today-card error">
                            <div class="today-icon">‚ùå</div>
                            <div class="today-value" id="today_cancelled">0</div>
                            <div class="today-label">Cancelados</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Agendamentos Tab -->
            <div class="admin-tab-content" data-content="agendamentos" style="display: none;">
                <h2>Gerenciar Agendamentos</h2>
                
                <!-- Filtros -->
                <div class="filters">
                    <button class="filter-btn active" data-status="all">Todos</button>
                    <button class="filter-btn" data-status="pending">Pendentes</button>
                    <button class="filter-btn" data-status="confirmed">Confirmados</button>
                    <button class="filter-btn" data-status="completed">Completados</button>
                    <button class="filter-btn" data-status="cancelled">Cancelados</button>
                </div>
                
                <!-- Lista de Agendamentos -->
                <div id="appointmentsList" class="appointments-list">
                    <div class="loader-container">
                        <div class="loader"></div>
                        <p>Carregando agendamentos...</p>
                    </div>
                </div>
            </div>
            
            <!-- Servi√ßos Tab -->
            <div class="admin-tab-content" data-content="servicos" style="display: none;">
                <div class="tab-header">
                    <h2>Gerenciar Servi√ßos</h2>
                    <button class="btn btn-primary" onclick="openServiceModal()">‚ûï Novo Servi√ßo</button>
                </div>
                
                <!-- Lista de Servi√ßos -->
                <div id="servicesList" class="services-grid">
                    <div class="loader-container">
                        <div class="loader"></div>
                        <p>Carregando servi√ßos...</p>
                    </div>
                </div>
            </div>
            
            <!-- Barbeiros Tab -->
            <div class="admin-tab-content" data-content="barbeiros" style="display: none;">
                <div class="tab-header">
                    <h2>Gerenciar Barbeiros</h2>
                    <button class="btn btn-primary" onclick="openBarberModal()">‚ûï Novo Barbeiro</button>
                </div>
                
                <!-- Lista de Barbeiros -->
                <div id="barbersList" class="barbers-grid">
                    <div class="loader-container">
                        <div class="loader"></div>
                        <p>Carregando barbeiros...</p>
                    </div>
                </div>
            </div>
            
            <!-- Cupons Tab -->
            <div class="admin-tab-content" data-content="cupons" style="display: none;">
                <div class="tab-header">
                    <h2>Gerenciar Cupons</h2>
                    <button class="btn btn-primary" onclick="openCouponModal()">‚ûï Novo Cupom</button>
                </div>
                
                <!-- Filtros de Cupons -->
                <div class="filters">
                    <button class="coupon-filter-btn active" data-filter="all">Todos</button>
                    <button class="coupon-filter-btn" data-filter="active">Ativos</button>
                    <button class="coupon-filter-btn" data-filter="expired">Expirados</button>
                </div>
                
                <!-- Lista de Cupons -->
                <div id="couponsList" class="coupons-list">
                    <div class="loader-container">
                        <div class="loader"></div>
                        <p>Carregando cupons...</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Modal para Servi√ßos -->
<div id="serviceModal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <h3 id="serviceModalTitle">Novo Servi√ßo</h3>
            <button class="modal-close" onclick="closeServiceModal()">‚úï</button>
        </div>
        <form id="serviceForm">
            <input type="hidden" id="serviceId">
            <div class="form-group">
                <label>Nome do Servi√ßo *</label>
                <input type="text" id="serviceName" class="form-control" required>
            </div>
            <div class="form-group">
                <label>Descri√ß√£o</label>
                <textarea id="serviceDescription" class="form-control" rows="3"></textarea>
            </div>
            <div class="form-group">
                <label>Pre√ßo (R$) *</label>
                <input type="number" id="servicePrice" class="form-control" step="0.01" required>
            </div>
            <div class="form-group">
                <label>Dura√ß√£o (minutos) *</label>
                <input type="number" id="serviceDuration" class="form-control" required>
            </div>
            <div class="form-group">
                <label>
                    <input type="checkbox" id="serviceActive" checked>
                    Servi√ßo Ativo
                </label>
            </div>
            <div class="modal-actions">
                <button type="button" class="btn btn-outline" onclick="closeServiceModal()">Cancelar</button>
                <button type="submit" class="btn btn-primary">Salvar</button>
            </div>
        </form>
    </div>
</div>

<!-- Modal para Barbeiros -->
<div id="barberModal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <h3 id="barberModalTitle">Novo Barbeiro</h3>
            <button class="modal-close" onclick="closeBarberModal()">‚úï</button>
        </div>
        <form id="barberForm">
            <input type="hidden" id="barberId">
            <div class="form-group">
                <label>Nome Completo *</label>
                <input type="text" id="barberName" class="form-control" required>
            </div>
            <div class="form-group">
                <label>Email *</label>
                <input type="email" id="barberEmail" class="form-control" required>
            </div>
            <div class="form-group">
                <label>Telefone</label>
                <input type="tel" id="barberPhone" class="form-control">
            </div>
            <div class="form-group">
                <label>Especialidades</label>
                <textarea id="barberSpecialties" class="form-control" rows="2" placeholder="Ex: Cortes cl√°ssicos, Barbas, Penteados"></textarea>
            </div>
            <div class="form-group">
                <label>
                    <input type="checkbox" id="barberActive" checked>
                    Barbeiro Ativo
                </label>
            </div>
            <div class="modal-actions">
                <button type="button" class="btn btn-outline" onclick="closeBarberModal()">Cancelar</button>
                <button type="submit" class="btn btn-primary">Salvar</button>
            </div>
        </form>
    </div>
</div>

<!-- Modal para Cupons -->
<div id="couponModal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <h3 id="couponModalTitle">Novo Cupom</h3>
            <button class="modal-close" onclick="closeCouponModal()">‚úï</button>
        </div>
        <form id="couponForm">
            <input type="hidden" id="couponId">
            <div class="form-group">
                <label>C√≥digo do Cupom *</label>
                <input type="text" id="couponCode" class="form-control" placeholder="Ex: PROMO10" required>
            </div>
            <div class="form-group">
                <label>Tipo de Desconto *</label>
                <select id="couponType" class="form-control" required>
                    <option value="percentage">Percentual (%)</option>
                    <option value="fixed">Valor Fixo (R$)</option>
                </select>
            </div>
            <div class="form-group">
                <label>Valor do Desconto *</label>
                <input type="number" id="couponValue" class="form-control" step="0.01" required>
            </div>
            <div class="form-group">
                <label>Data de Expira√ß√£o</label>
                <input type="date" id="couponExpiration" class="form-control">
            </div>
            <div class="form-group">
                <label>Limite de Uso</label>
                <input type="number" id="couponLimit" class="form-control" placeholder="Deixe vazio para ilimitado">
            </div>
            <div class="form-group">
                <label>
                    <input type="checkbox" id="couponActive" checked>
                    Cupom Ativo
                </label>
            </div>
            <div class="modal-actions">
                <button type="button" class="btn btn-outline" onclick="closeCouponModal()">Cancelar</button>
                <button type="submit" class="btn btn-primary">Salvar</button>
            </div>
        </form>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script src="{% static 'js/admin.js' %}"></script>
{% endblock %}

